//main起動
//Nimbleディレクトリからコンソールで "node public/index.js"
//skyway起動
//コンソールで "php -S localhost:8080"



//ファイル送受信のプロセス
//---------------------
//1.ファイルをstorageへ送信
//2.storageに保存されたファイルのurlを取得
//3.取得したurlをRealtimeDatabaseに記録
//4.RDが各ユーザーに追加されたデータを送る  （onChildAdded）
//5.送信されたデータをメッセージ・画像・ファイルに応じた方法で表示 (appendMessage等)


//onChildAdded と チャンネル移動 について
//----------------------------------
//起動時に ①既存データを取得 ②データ更新されるたびに新データを取得し処理を行う
//①を利用してデータを取り込むことで部屋移動の際のデータ表示を行いたい
//しかし、部屋移動毎に②の部分が残り待機してしまう
//結果、複数回部屋移動を行なったのち新しく投稿を行うと、待機していた移動回数分のonChildAddedがその数だけappendContentを行い、投稿がダブる
//
//解決策として、
//静的な変数killNumberを用意する。
//killNumberの値は部屋移動毎に ＋１ される
//onChildAddedCollerが呼び出される際、killNumberを渡し、これをmyNumberとして保持させる
//appendContentが行われる際、myNumberとkillNumberの照合を行い、結果がfalseの場合appendContentは行わないようにする
//（最新のkillNumberを保持していないonChildAddedは処理を持たない状態になる）


//チャンネルリストの作成・更新
//---------------------
// window読み込み時にonChildAddedで'channelList'を参照
// 取得したデータをボタンにしてチャンネルリストに追加
// チャンネル追加フォームに入力された値を'channelList'に送信
// onChildAddedがリストの変更を検知し自動で更新
// 重複したチャンネル名が存在しないようにチャンネル追加の前にsetで検証

スタンプの追加
---------------
全体
1.スタンプボタンからスタンプを押す
2.押したスタンプがfirebaseに記録される
3.更新が行われる

スタンプの押された回数と種類をHTMLに保持させる

詳細
1.スタンプボタンからスタンプを押す
    スタンプボタンを押したときにイベントリスナーが起動
    現在押されている回数＋１した値を新しくスタンプの押された回数とする
    押したスタンプの番号とどのメッセージに押したかが特定できるIDを渡す
    

2.押したスタンプがfirebaseに記録される
    スタンプが押されたことを示す情報を記録
    データ構成に必要なもの
        スタンプの番号：回数？？


3.更新が行われる
    onChildChangedが更新を検知
    onChildChangedのなかみ
        appendContentのように更新用メソッドを呼び出す
        更新用メソッドの中身
            更新が行われたメッセージを特定するIDを受け取り、一致するメッセージのオブジェクトを取得？？
            取得したオブジェクトにappendする形でタグに入れたスタンプを追加？？

更新
一度要素を読み込んだら固定される
イベントリスナーが終わるたびに値を更新？

初期イベントリスナー定義
起動
イベント処理完了
イベントリスナー削除
イベントリスナー再定義

kitagawaブランチの変更テスト